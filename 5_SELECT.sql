# –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –∑–Ω–∞—á–µ–Ω—å –±–µ–∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –±—É–¥—å-—è–∫–æ–≥–æ –¥–∂–µ—Ä–µ–ª–∞
  
SELECT
    	1	  AS nmb_1
	,2	  AS nmb_2
	,5+5      AS nmb_3;

# –ó–Ω–∞–π–æ–º—Å—Ç–≤–æ –∑ —Ç–∞–±–ª–∏—Ü–µ—é: –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –∑–Ω–∞—á–µ–Ω—å –≤ —Ç–∞–±–ª–∏—Ü—ñ —ñ –∫–æ–ª–æ–Ω—Ü—ñ, –∞ —Ç–∞–∫–æ–∂ —É–Ω—ñ–∫–∞–ª—å–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å –≤ –∫–æ–ª–æ–Ω—Ü—ñ
  
SELECT 
	COUNT(*)			        AS cnt_all
	, COUNT(exp_level)	 		 AS cnt_level
	, COUNT(DISTINCT exp_level)
FROM salaries
LIMIT 10;

# –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –¥–µ—è–∫–∏—Ö –æ–ø–∏—Å–æ–≤–∏—Ö —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫ –ø–æ –≤–∫–∞–∑–∞–Ω—ñ–π –∫–æ–ª–æ–Ω—Ü—ñ
  
SELECT 
	AVG(salary_in_usd)	   	AS salary_avg
	, MIN(salary_in_usd)   		AS salary_min
	, MAX(salary_in_usd)   		AS salary_max
FROM salaries
WHERE year = '2023'
LIMIT 10;

# –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è –Ω–æ–≤–∏—Ö –∫–æ–ª–æ–Ω–æ–∫ –∑–∞ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫–æ–º —Ç–∞ —É–º–æ–≤–æ—é

SELECT 
	year
	, exp_level
	, salary_in_usd
	, salary_in_usd * 38	      AS salary_in_uah
	, CASE
		WHEN exp_level = 'SE'
		  THEN 'Senior'
		WHEN exp_level = 'MI'
		  THEN 'Middle'
		ELSE 'Other' 
    END 		                  AS full_level
FROM salaries
LIMIT 100;

# üëá –î–æ–¥–∞—Ç–∫–æ–≤—ñ –≤–ø—Ä–∞–≤–∏ –¥–ª—è –ø—Ä–∞–∫—Ç–∏–∫–∏: 

/* 1. –í–∏–≤–µ—Å—Ç–∏ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —É–Ω—ñ–∫–∞–ª—å–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å –¥–ª—è –∫–æ–∂–Ω–æ—ó –∫–æ–ª–æ–Ω–∫–∏, 
—â–æ –º—ñ—Å—Ç–∏—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—ñ –∑–Ω–∞—á–µ–Ω–Ω—è. 
P.s. –ú–∏ –Ω–µ —Ñ—ñ–ª—å—Ç—Ä—É—î–º–æ —Ç–∞–±–ª–∏—Ü—é, –≤–∏–≤–æ–¥—è—á–∏ –∫–æ–ª–æ–Ω–∫–∏ –ø–µ–≤–Ω–æ–≥–æ —Ç–∏–ø—É –¥–∞–Ω–∏—Ö.
–ù–∞—Ç–æ–º—ñ—Å—Ç—å, –º–∏ –ø—Ä–æ—Å—Ç–æ –¥–æ—Å–ª—ñ–¥–∂—É—î–º–æ –∫–æ–∂–Ω—É –æ–∫—Ä–µ–º—É –∫–æ–ª–æ–Ω–∫—É, –¥–µ –±–∞—á–∏–º–æ —Ç–µ–∫—Å—Ç–æ–≤—ñ –¥–∞–Ω—ñ
*/

SELECT COUNT(DISTINCT job_title)
FROM salaries;

/* 2. –í–∏–≤–µ—Å—Ç–∏ —É–Ω—ñ–∫–∞–ª—å–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è –∫–æ–∂–Ω–æ—ó –∫–æ–ª–æ–Ω–∫–∏, 
—â–æ –º—ñ—Å—Ç–∏—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—ñ –∑–Ω–∞—á–µ–Ω–Ω—è. 
(SELECT DISTINCT column_name FROM salaries) */

SELECT DISTINCT job_title
FROM salaries
ORDER BY 1 ASC;

/* 3. –í–∏–≤–µ—Å—Ç–∏ —Å–µ—Ä–µ–¥–Ω—é, –º—ñ–Ω—ñ–º–∞–ª—å–Ω—É —Ç–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É –∑/–ø (salary_in_usd)
–¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —Ä–æ–∫—É (–æ–∫—Ä–µ–º–∏–º–∏ –∑–∞–ø–∏—Ç–∞–º–∏, –≤ –∫–æ–∂–Ω–æ–º—É –∑ —è–∫–∏—Ö 
–≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–æ —Ñ—ñ–ª—å—Ç—Ä –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ–≥–æ —Ä–æ–∫—É) */

SELECT 
	ROUND(AVG(salary_in_usd),0)	AS avg_salary
	, MIN(salary_in_usd)		AS min_salary
	, MAX(salary_in_usd)		AS max_salary
FROM salaries
WHERE year = '2021';

/* 4. –í–∏–≤–µ—Å—Ç–∏ —Å–µ—Ä–µ–¥–Ω—é –∑/–ø (salary_in_usd) –¥–ª—è 2023 —Ä–æ–∫—É –ø–æ 
–∫–æ–∂–Ω–æ–º—É —Ä—ñ–≤–Ω—é –¥–æ—Å–≤—ñ–¥—É –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫—ñ–≤ (–æ–∫—Ä–µ–º–∏–º–∏ –∑–∞–ø–∏—Ç–∞–º–∏, 
–≤ –∫–æ–∂–Ω–æ–º—É –∑ —è–∫–∏—Ö –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–æ —Ñ—ñ–ª—å—Ç—Ä —Ä–æ–∫—É —Ç–∞ –¥–æ—Å–≤—ñ–¥—É). */

SELECT ROUND(AVG(salary_in_usd),0)	AS avg_salary
FROM salaries
WHERE year = 2023 AND exp_level = 'MI';

/* 5. –í–∏–≤–µ—Å—Ç–∏ 5 –Ω–∞–π–≤–∏—â–∏—Ö –∑–∞—Ä–æ–±—ñ—Ç–Ω–∏—Ö –ø–ª–∞—Ç –≤ 2023 —Ä–æ—Ü—ñ –¥–ª—è 
–ø—Ä–µ–¥—Å—Ç–∞–≤–Ω–∏–∫—ñ–≤ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–æ—Å—Ç—ñ ML Engineer. 
–ó–∞—Ä–æ–±—ñ—Ç–Ω—ñ –ø–ª–∞—Ç–∏ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –≤ –≥—Ä–∏–≤–Ω—ñ. */

SELECT
	year
	, job_title
	, salary_in_usd
	, salary_in_usd * 38 	AS salary_in_uah
FROM salaries
WHERE
	year = 2023
	AND job_title = 'ML Engineer'
ORDER BY 4 DESC
LIMIT 5;

/* 6. –í–∏–≤–µ—Å—Ç–∏ –£–Ω—ñ–∫–∞–ª—å–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –∫–æ–ª–æ–Ω–∫–∏ remote_ratio, 
—Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–∏—Ö –º–∞—î –±—É—Ç–∏ –¥—Ä–æ–±–æ–≤–∏–º –∑ –¥–≤–æ–º–∞ –∑–Ω–∞–∫–∞–º–∏ –ø—ñ—Å–ª—è –∫–æ–º–∏, 
–ø—Ä–∏–∫–ª–∞–¥: –∑–Ω–∞—á–µ–Ω–Ω—è 50 –º–∞—î –≤—ñ–¥–æ–±—Ä–∞–∂–∞—Ç–∏—Å—å –≤ —Ñ–æ—Ä–º–∞—Ç—ñ 0.50 */

SELECT DISTINCT ROUND(remote_ratio/100.0,2) AS remote_ratio
FROM salaries;

/* 7. –í–∏–≤–µ—Å—Ç–∏ –¥–∞–Ω—ñ —Ç–∞–±–ª–∏—Ü—ñ, –¥–æ–¥–∞–≤—à–∏ –∫–æ–ª–æ–Ω–∫—É 'exp_level_full' 
–∑ –ø–æ–≤–Ω–æ—é –Ω–∞–∑–≤–æ—é —Ä—ñ–≤–Ω—ñ–≤ –¥–æ—Å–≤—ñ–¥—É –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫—ñ–≤ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –¥–æ –∫–æ–ª–æ–Ω–∫–∏ 
exp_level. 
–í–∏–∑–Ω–∞—á–µ–Ω–Ω—è: Entry-level (EN), Mid-level (MI), Senior-level (SE), 
Executive-level (EX) */

SELECT *
	, CASE  
		WHEN exp_level = 'EN' THEN 'Entry-level'
		WHEN exp_level = 'MI' THEN 'Mid-level'
		WHEN exp_level = 'SE' THEN 'Senior-level'
		WHEN exp_level = 'EX' THEN 'Executive-level'
		END AS exp_level_full
FROM salaries
LIMIT 100;


/* 8. –î–æ–¥–∞—Ç–∫–∏ –∫–æ–ª–æ–Ω–∫—É "salary_category', —è–∫–∞ –±—É–¥–µ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—Ç–∏ 
—Ä—ñ–∑–Ω—ñ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó –∑–∞—Ä–æ–±—ñ—Ç–Ω–∏—Ö –ø–ª–∞—Ç –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –¥–æ —ó—Ö –∑–Ω–∞—á–µ–Ω–Ω—è 
–≤ –∫–æ–ª–æ–Ω—Ü—ñ 'salary_in_usd'. 

–í–∏–∑–Ω–∞—á–µ–Ω–Ω—è: 
–∑/–ø –º–µ–Ω—à–∞ –∑–∞ 20 000 - –ö–∞—Ç–µ–≥–æ—Ä—ñ—è 1, 
–∑/–ø –º–µ–Ω—à–∞ –∑–∞ 50 000 - –ö–∞—Ç–µ–≥–æ—Ä—ñ—è 2, 
–∑/–ø –º–µ–Ω—à–∞ –∑–∞ 100 000 - –ö–∞—Ç–µ–≥–æ—Ä—ñ—è 3, 
–∑/–ø –±—ñ–ª—å—à–∞ –∑–∞ 100 000 - –ö–∞—Ç–µ–≥–æ—Ä—ñ—è 4 */


SELECT *
	, CASE  
		WHEN salary_in_usd <= 20000 THEN '–ö–∞—Ç–µ–≥–æ—Ä—ñ—è 1'
		WHEN salary_in_usd <= 50000 THEN '–ö–∞—Ç–µ–≥–æ—Ä—ñ—è 2'
		WHEN salary_in_usd <= 100000 THEN '–ö–∞—Ç–µ–≥–æ—Ä—ñ—è 3'
		ELSE '–ö–∞—Ç–µ–≥–æ—Ä—ñ—è 4' END AS salary_category
FROM salaries
LIMIT 100;


/* 9. –î–æ—Å–ª—ñ–¥–∏—Ç–∏ –≤—Å—ñ –∫–æ–ª–æ–Ω–∫–∏ –Ω–∞ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –≤—ñ–¥—Å—É—Ç–Ω—ñ—Ö –∑–Ω–∞—á–µ–Ω—å, 
–ø–æ—Ä—ñ–≤–Ω—è–≤—à–∏ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ä—è–¥–∫—ñ–≤ —Ç–∞–±–ª–∏—Ü—ñ –∑ –∫—ñ–ª—å–∫—ñ—Å—Ç—é –∑–Ω–∞—á–µ–Ω—å –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—ó 
–∫–æ–ª–æ–Ω–∫–∏ */

SELECT 
	COUNT(*)					AS total_nmb
	, COUNT(job_title)				AS dist_nmb
	, COUNT(*) - COUNT(job_title) 			AS null_nmb
FROM salaries;

/* 10. –ü–æ—Ä–∞—Ö—É–≤–∞—Ç–∏ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫—ñ–≤ –≤ —Ç–∞–±–ª–∏—Ü—ñ, 
—è–∫—ñ –≤ 2023 —Ä–æ—Ü—ñ –ø—Ä–∞—Ü—é—é—Ç—å –Ω–∞ –∫–æ–º–ø–∞–Ω—ñ—ó —Ä–æ–∑–º—ñ—Ä—É "–ú" —ñ –æ—Ç—Ä–∏–º—É—é—Ç—å 
–∑/–ø –≤–∏—â—É –∑–∞ $100 000 */

SELECT COUNT(salary_in_usd)
FROM salaries
WHERE 1=1
	AND year = '2023'
	AND company_size = 'M'
	AND salary_in_usd >= 100000;
